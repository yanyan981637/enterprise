<?php
/**
 * Copyright Â© Magefan (support@magefan.com). All rights reserved.
 * Please visit Magefan.com for license details (https://magefan.com/end-user-license-agreement).
 */
?>
<?php
/**
 * @var $block \Magefan\Community\Block\
 * @var $mfSecureRenderer \Magefan\Community\Api\SecureHtmlRendererInterface
 */
?>
<?php
    $mapCodeLine = '`${key0}${keysRest.map(a => `[${a}]`).join(\'\')}=${value}`)';
 ?>
<?php $script = "
    window.MagefanJs = window.MagefanJs || {};
    window.MagefanJs.objToUrlParams = function(obj) {
        let getPairs = (obj, keys = []) =>
            Object.entries(obj).reduce((pairs, [key, value]) => {
                if (typeof value === 'object')
                    pairs.push(...getPairs(value, [...keys, key]));
                else
                    pairs.push([[...keys, key], value]);
                return pairs;
            }, []);

        let x = getPairs(obj)
            .map(([[key0, ...keysRest], value]) =>
               {$mapCodeLine}
            .join('&');

        return x;
    };
"; ?>
<?= /* @noEscape */ $mfSecureRenderer->renderTag('script', [], $script, false) ?>
